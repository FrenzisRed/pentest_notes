<h2 align="center">Password Attack Techniques</h2>

<b>1 [Intro](#1-Intro)</b>

<b>2 [Password Profiling](#2-Password-Profiling)</b>

    1 Default Passwords  
    2 Weak Passwords  
    3 Leaked Passwords  
    4 Combined Wordlists  
    5 Customized Wordlists  
    6 Username Wordlists
    7 Other Techniques  

<b>3 [Offline Attacks](#3-Offline-Attacks)</b>

    1 Dictionary attack  
    2 Brute-Force attack  
    3 Rule-Based attacks  
    4 Custom Rules  

<b>4 [Online Attacks](#4-Online-Attacks)</b>

    1 Hydra

<b>5 [Password Spray Attacks](#5-Password-Spray-Attacks)</b>


## <h3 align="center">1 Intro</h3>

Having a good wordlist is critical to carrying out a successful password attack. It is important to know how you can generate username lists and password lists.  

## <h3 align="center">2 Password Profiling</h3>

<b>Default Passwords:</b>

Before performing password attacks, it is worth trying a couple of default passwords against the targeted service. Manufacturers set default passwords with products and equipment such as switches, firewalls, routers. There are scenarios where customers don't change the default password, which makes the system vulnerable.

For example: admin:admin, admin:123456, tomcat:admin, etc..  

Here are some website lists that provide default passwords for various products.

    https://cirt.net/passwords
    https://default-password.info/
    https://datarecovery.com/rd/default-passwords/

<b>Weak Passwords:</b>

These lists may also contain leaked passwords or just simple passwords that have been published publicly. Here are some of the common weak passwords lists :

https://wiki.skullsecurity.org/index.php?title=Passwords - This includes the most well-known collections of passwords.  
[SecLists](https://github.com/danielmiessler/SecLists/tree/master/Passwords) - A huge collection of all kinds of lists, not only for password cracking.  

<b>Leaked Passwords:</b>

These public or privately available leaks are often referred to as 'dumps'. Depending on the contents of the dump, an attacker may need to extract the passwords out of the data. In some cases, the dump may only contain hashes of the passwords and require cracking in order to gain the plain-text passwords. The following are some of the common password lists that have weak and leaked passwords, including webhost, elitehacker,hak5, Hotmail, PhpBB companies' leaks:

[SecLists/Passwords/Leaked-Databases](https://github.com/danielmiessler/SecLists/tree/master/Passwords/Leaked-Databases)  

<b>Combined wordlists:</b>

Let's say that we have more than one wordlist. Then, we can combine these wordlists into one large file. This can be done as follows using cat:

    cat file1.txt file2.txt file3.txt > combined_list.txt

To clean up the generated combined list to remove duplicated words, we can use sort and uniq as follows:

    sort combined_list.txt | uniq -u > cleaned_combined_list.txt

<b>Customized Wordlists:</b>

Customized Wordlists

Customizing password lists is one of the best ways to increase the chances of finding valid credentials. We can create custom password lists from the target website. Often, a company's website contains valuable information about the company and its employees, including emails and employee names. In addition, the website may contain keywords specific to what the company offers, including product and service names, which may be used in an employee's password!

Tools such as Cewl can be used to effectively crawl a website and extract strings or keywords. Cewl is a powerful tool to generate a wordlist specific to a given company or target. Consider the following example below:


user@kali$ cewl -w list.txt -d 5 -m 5 http://corriere.it

<b>Username Wordlists:</b>

Gathering employees' names in the enumeration stage is essential. We can generate username lists from the target's website. For the following example, we'll assume we have a {first name} {last name} (ex: Mario Rossi) and a method of generating usernames.

    {first name}: Mario
    {last name}: Rossi
    {first name}{last name}:  mariorossi
    {last name}{first name}:  rossimario
    first letter of the {first name}{last name}: mrossi
    first letter of the {last name}{first name}: rmario  
    first letter of the {first name}.{last name}: m.rossi
    first letter of the {first name}-{last name}: m-rossi
    and so on

There is a tool username_generator that could help create a list with most of the possible combinations if we have a first name and last name called username_generator available via git:

    git clone https://github.com/therodri2/username_generator.git

<b>Keyspace Technique</b>

In this technique, we specify a range of characters, numbers, and symbols in our wordlist. crunch is one of many powerful tools for creating an offline wordlist. With crunch, we can specify numerous options, including min, max, and options.

The following example creates a wordlist containing all possible combinations of 2 characters, including 0-4 and a-d. We can use the -o argument and specify a file to save the output to.

    user@kali$ crunch 2 2 01234abcd -o crunch.txt

crunch also lets us specify a character set using the -t option to combine words of our choice. Here are some of the other options that could be used to help create different combinations of your choice:

    @ - lower case alpha characters

    , - upper case alpha characters

    % - numeric characters

    ^ - special characters including space

For example, if part of the password is known to us, and we know it starts with pass and follows two numbers, we can use the % symbol from above to match the numbers. Here we generate a wordlist that contains pass followed by 2 numbers:

    user@kali$  crunch 6 6 -t pass%%

<b>CUPP - Common User Passwords Profiler</b>

CUPP is an automatic and interactive tool written in Python for creating custom wordlists. For instance, if you know some details about a specific target, such as their birthdate, pet name, company name, etc., this could be a helpful tool to generate passwords based on this known information. CUPP will take the information supplied and generate a custom wordlist based on what's provided. There's also support for a 1337/leet mode, which substitutes the letters a, i,e, t, o, s, g, z  with numbers. For example, replace a  with 4  or i with 1. For more information about the tool, please visit the GitHub repo:

    git clone https://github.com/Mebus/cupp.git

## <h3 align="center">3 Offline Attacks</h3>

<b>Dictionary attack</b>

A dictionary attack is a technique used to guess passwords by using well-known words or phrases. The dictionary attack relies entirely on pre-gathered wordlists that were previously generated or found. It is important to choose or create the best candidate wordlist for your target in order to succeed in this attack.


Let's say that we obtain the following hash ``f806fc5a2a0d5ba2471600758452799c``, and want to perform a dictionary attack to crack it. First, we need to know the following at a minimum:

1- What type of hash is this?
2- What wordlist will we be using? Or what type of attack mode could we use?

To identify the type of hash, we could a tool such as `hashid` or `hash-identifier`. For this example, hash-identifier believed the possible hashing method is MD5

Classic hashcat command:

    user@kali$ hashcat -a 0 -m 0 f806fc5a2a0d5ba2471600758452799c /usr/share/wordlists/rockyou.txt

details to remember:

    -a 0  sets the attack mode to a dictionary attack

    -m 0  sets the hash mode for cracking MD5 hashes; for other types, run hashcat -h for a list of supported hashes.

    f806fc5a2a0d5ba2471600758452799c this option could be a single hash like our example or a file that contains a hash or multiple hashes.

    /usr/share/wordlists/rockyou.txt the wordlist/dictionary file for our attack

We run hashcat with --show option to show the cracked value if the hash has been cracked:

    user@machine$ hashcat -a 0 -m 0 F806FC5A2A0D5BA2471600758452799C /usr/share/wordlists/rockyou.txt --show
    f806fc5a2a0d5ba2471600758452799c:rockyou

[Hashcat wiki](https://hashcat.net/wiki/doku.php?id=hashcat)            

## <h3 align="center">4 Online Attacks</h3>

Hydra supports an extensive list of network services to attack. Using hydra, we'll brute-force network services such as web login pages, FTP, SMTP, and SSH in this section. Often, within hydra, each service has its own options and the syntax hydra expects takes getting used to. It's important to check the help options for more information and features.
